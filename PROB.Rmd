---
title: "PROBABILITY"
author: "Hodonou william"
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: journal
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r echo = FALSE, include=FALSE}
rm(list=ls())

library(ggplot2)
library(gridExtra)
library(pander)
library(tidyverse)
library(reshape2)

```


### Simulate distributions
```{r}
set.seed(123) # Set random seed
trials <- 0:60
df_dist <- data.frame(trials=trials,
                      binomial_p_03=dbinom(x=trials, size=60, prob=0.25),
                      binomial_p_05=dbinom(x=trials, size=60, prob=0.57),
                      binomial_p_08=dbinom(x=trials, size=60, prob=0.8))
```

### Visualize
```{r fig.height=4, fig.width=8}
# p=0.3 Distribution
g1 <- ggplot(data=df_dist, aes(x=trials)) + 
  geom_area(aes(y=df_dist$binomial_p_03), fill="darkblue", alpha=0.4) +
  labs(title="Plot I - III",
       subtitle="Binomial distribution (p=0.3)") +
  theme_minimal() +
  ylab("Probabilty") + 
  ylim(0, 0.13) +
  xlab("n successful trials (k)")

# p=0.5 Distribution
g2 <- ggplot(data=df_dist, aes(x=trials)) + 
  geom_area(aes(y=df_dist$binomial_p_05), fill="black", alpha=0.4) +
  labs(title="",
       subtitle="Binomial distribution (p=0.5)") +
  theme_minimal() +
  theme(axis.text.y = element_blank()) +
  ylab("") + 
  ylim(0, 0.13) +
  xlab("n successful trials (k)")

# p=0.8 Distribution
g3 <- ggplot(data=df_dist, aes(x=trials)) + 
  geom_area(aes(y=df_dist$binomial_p_08), fill="darkred", alpha=0.4) +
  labs(title="",
       subtitle="Binomial distribution (p=0.8)") +
  theme_minimal() +
  theme(axis.text.y = element_blank()) +
  ylab("") + 
  ylim(0, 0.13) +
  xlab("n successful trials (k)")

# Plot grid
grid.arrange(g1, g2, g3, nrow=1, ncol=3)
```

## ii) One graph
Subsequently, place all three curves on the same graph.

### Visualize
```{r fig.height=4, fig.width=8}
ggplot(data=df_dist, aes(x=trials)) + 
  geom_area(aes(y=df_dist$binomial_p_03), fill="darkblue", alpha=0.4) +
  geom_area(aes(y=df_dist$binomial_p_05), fill="black", alpha=0.4) +
  geom_area(aes(y=df_dist$binomial_p_08), fill="darkred", alpha=0.4) +
  labs(title="Plot IV",
       subtitle="Binomial distribution with p=0.3, p=0.5, p=0.8") +
  theme_minimal() +
  scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
  ylab("Probabilty") + 
  xlab("Number of successful trials (k)") +
  geom_text(x=df_dist$trials[df_dist$binomial_p_03==max(df_dist$binomial_p_03)],
            y=0.03, label="Prob: 0.3", size=4) +
  geom_text(x=df_dist$trials[df_dist$binomial_p_05==max(df_dist$binomial_p_05)],
            y=0.03, label="Prob: 0.5", size=4) +
  geom_text(x=df_dist$trials[df_dist$binomial_p_08==max(df_dist$binomial_p_08)],
            y=0.03, label="Prob: 0.8", size=4)
```

## iii) Summary statistics
For each value of $p$, determine 1st Quartile, median, mean, standard deviation and the 3rd Quartile.

### Function to calculate summary statistics
```{r}
summaryStat <- function(n, p){
  Prob <- p 
  Quart_1 <- qbinom(0.25, size=n, prob=p) 
  Median <- qbinom(0.5, size=n, prob=p) 
  Mean <- n * p
  Std <- sqrt(n * p * (1 - p))
  Quart_3 <- qbinom(0.75, size=n, prob=p) 
  data.frame(Prob, Quart_1, Median, Mean, Std, Quart_3)
}
```

### Table I: Summary Statistics
```{r}
pander(rbind(summaryStat(60, 0.3), summaryStat(60, 0.5), summaryStat(60, 0.8)))
```
The above table shows how the values change alonge the different $p$ values.

## iv) Boxplot
Present those values as a vertical box plot with the probability p on the horizontal axis.   

In order to generate a boxplot the easiest way is to simulate the data with different probabilty values ($p$). A number of 100'000 trials should be sufficient so that the real values lie close to simulated ones. *Note:* The central limit theorem (CLT) shows, that from a n>30 the mean of the values distribute themself normally around the true value. 

### Generate data
```{r, warning=FALSE, message=FALSE}
# Simulation
set.seed(123) # Set random seed
df_sim <- data.frame(Prob_0.3=rbinom(100000, size = 60, prob = 0.3),
                     Prob_0.5=rbinom(100000, size = 60, prob = 0.5), 
                     Prob_0.8=rbinom(100000, size = 60, prob = 0.8))
df_sim2 <- melt(df_sim)

```

### Table II: Simulated data
```{r}
pander(summary(df_sim))
```
The above table shows, that the summary statistics of the simulated data gives the same numbers as seen before. We can therefore safely assume, that the numbers are correct.

### Summary statistics
In order to visualize the summary values in the boxplot format a function that compute the mean-1SE, and Mean+1SE has to be written.

```{r}
newSummaryStat <- function(x) {
  vec_var <- c(min(x), mean(x) - sd(x)/sqrt(length(x)), mean(x),
               mean(x) + sd(x)/sqrt(length(x)), max(x))
  names(vec_var) <- c("ymin", "lower", "middle", "upper", "ymax")
  vec_var
}
```

### Visualize
```{r}
ggplot(data=df_sim2, aes(x=variable, y=value)) +
  geom_boxplot(fill=c("darkblue", "black", "darkred"), alpha=0.4) +
  labs(title="Plot V",
       subtitle="Ind. Boxplots succesfull trials (k) over probabilities (p)") +
  stat_summary(fun.data=newSummaryStat, geom="boxplot") + 
  theme_minimal() +
  ylab("Number of succefull trials (k)") + 
  xlab("Probability (p)")
```